<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAPA DE ESTOCAGEM DE PRODUTOS CONTROLADOS</title>
   
   
   
<style>
    /* Estilos gerais para o corpo da página */
    body {
        font-family: Arial, sans-serif;
        background-color: #f0f0f0;
        margin: 0;
        padding: 20px;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    /* Estilo do container do formulário */
    .form-container {
        background-color: #ffffff;
        padding: 30px;
        border-radius: 20px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        width: 100%;
        max-width: 900px;
        overflow-y: auto;
    }

    /* Estilo do título principal */
    h1 {
        font-size: 24px;
        color: #333;
        text-align: center;
        margin-bottom: 20px;
    }

    /* Estilo para grupos de campos do formulário */
    .form-group {
        margin-bottom: 15px;
    }

    /* Estilo para as labels dos campos */
    label {
        font-size: 12px;
        color: #555;
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
    }

    /* Estilo para campos de entrada (input, select e file) */
    input, select, input[type="file"] {
        width: 100%;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 7px;
        font-size: 14px;
        text-transform: uppercase;
        background-color: #f0f0f0; /* Cinza claro inicial */
        box-sizing: border-box;
    }

    /* Estilo específico para campos de seleção (select) */
    select {
        background-color: #f0f0f0; /* Cinza claro inicial */
    }

    /* Estilo para campos em foco (quando selecionados) */
    input:focus, select:focus {
        outline: none;
        border-color: #555555;
    }

    /* Estilo para o botão do formulário */
    .form-button {
        background-color: #85B5D9;
        color: white;
        padding: 12px 20px;
        font-size: 16px;
        border: none;
        border-radius: 20px;
        cursor: pointer;
        width: 100%;
        margin-top: 10px;
    }

    /* Estilo para o botão quando o mouse passa por cima */
    .form-button:hover {
        background-color: #0275C5;
    }

    /* Estilo para o container da logo */
    .logo-container {
        text-align: center;
        margin-bottom: 20px;
        width: auto;
        height: auto;
    }

    /* Estilo para a imagem da logo */
    .logo-container img {
        width: auto;
        height: auto;
        max-width: 100%;
    }

    /* Estilo para campos preenchidos */
    .form-group input.filled, .form-group select.filled {
        background-color: #e1f0ff; /* Azul clarinho quando preenchido */
    }
</style>   
   
   
   
      
   
		
</head>
<body>
    <div class="form-container">
        <div class="logo-container">
            <img src="imagem.png" alt="Logo">
        </div>



<title>Termo de Responsabilidade</title>
<style>
    /* Estilo para o título principal */
    h1 {
        text-align: center; /* Centraliza o texto */
        color: #333; /* Cor do texto */
        margin-bottom: 20px; /* Espaçamento abaixo do título */
    }

    /* Estilo para o container do Termo de Responsabilidade */
    .termo-responsabilidade {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); /* Adiciona uma sombra suave */
        text-align: justify; /* Alinha o texto justificado */
        background-color: #f9f9f9; /* Cor de fundo */
        padding-left: 30px; /* Espaçamento interno à esquerda */
        padding-right: 30px; /* Espaçamento interno à direita */
        padding-top: 10px; /* Espaçamento interno acima */
        padding-bottom: 10px; /* Espaçamento interno abaixo */		
		border: 1px solid #ccc; /* Borda cinza */
        border-radius: 20px; /* Bordas arredondadas */
        margin-top: 0px; /* Reduzi a margem superior */
        margin-bottom: 30px; /* Reduzi a margem inferior */
        font-size: 14px; /* Tamanho da fonte */
        line-height: 1.6; /* Espaçamento entre as linhas */
        color: #555; /* Cor do texto */
        height: 190px; /* Altura fixa da caixa */
	    font-size: 14px; /* Tamanho da fonte */
        background-color: #DDECF7; /* Cor de fundo */
    }
	


    /* Estilo para grupos de campos do formulário */
    .form-group {
        margin-bottom: 20px; /* Espaçamento entre os grupos */
    }

    /* Estilo para as labels dos campos */
    .form-group label {
        display: block; /* Faz a label ocupar a linha inteira */
        font-weight: bold; /* Texto em negrito */
        margin-bottom: 8px; /* Espaçamento abaixo da label */
        color: #333; /* Cor do texto */
    }

    /* Estilo para campos de seleção (select) */
    .form-group select {
        width: 100%; /* Largura total */
        padding: 10px; /* Espaçamento interno */
        border-radius: 5px; /* Bordas arredondadas */
        border: 1px solid #ccc; /* Borda cinza */
        font-size: 14px; /* Tamanho da fonte */
        background-color: #f0f0f0; /* Cor de fundo */
		color: #333; /* Cor do texto */
    }

    /* Estilo para campos de seleção quando estão em foco */
    .form-group select:focus {
        border-color: #66afe9; /* Muda a cor da borda para azul */
        outline: none; /* Remove o contorno padrão */
        box-shadow: 0 0 5px rgba(102, 175, 233, 0.5); /* Adiciona uma sombra suave */
    }

    /* Estilo para o botão */
    button {
        width: 100%; /* Largura total */
        padding: 12px; /* Espaçamento interno */
        background-color: #5cb85c; /* Cor de fundo verde */
        border: none; /* Remove a borda */
        border-radius: 5px; /* Bordas arredondadas */
        color: #fff; /* Cor do texto */
        font-size: 16px; /* Tamanho da fonte */
        cursor: pointer; /* Cursor de ponteiro ao passar o mouse */
    }

    /* Estilo para o botão quando o mouse passa por cima */
    button:hover {
        background-color: #4cae4c; /* Muda a cor de fundo para um verde mais escuro */
    }
</style>
    </style>
</head>
<body>
    <div class="container"> 
    

		<h1>LABORATÓRIO DE SANEAMENTO</h1>
		
        <form id="contact-form">
        
	     <!-- Termo de Responsabilidade -->	
			
			<!-- Campos do formulário -->
			<input type="hidden" id="data" name="data">
			<script>
				 document.addEventListener("DOMContentLoaded", function() {
				const opcoes = { day: 'numeric', month: 'long', year: 'numeric' };
				const dataAtual = new Date().toLocaleDateString('pt-BR', opcoes);
				document.getElementById("data").value = dataAtual;
				 });
			</script>
            <div class="form-group">
                <label for="acetona">ACETONA</label>
                <input type="text" id="acetona" name="acetona" placeholder="DIGITE O NOME COMPLETO SEM ABREVIAÇÕES" oninput="maiusculas(this); markAsFilled(this)" required autocomplete="off">
            </div>
			
            <div class="form-group">
                <label for="acidoCloridrico">ÁCIDO CLORÍDRICO</label>
                <input type="text" id="acidoCloridrico" name="acidoCloridrico" placeholder="DIGITE O NOME SOCIAL COMPLETO SEM ABREVIAÇÕES CASO POSSUA" autocomplete="off" oninput="maiusculas(this); markAsFilled(this)">
            </div>
			            <div class="form-group">
                <label for="nomeSocial">ÁCIDO SULFÚRICO</label>
                <input type="text" id="nomeSocial" name="nomeSocial" placeholder="DIGITE O NOME SOCIAL COMPLETO SEM ABREVIAÇÕES CASO POSSUA" autocomplete="off" oninput="maiusculas(this); markAsFilled(this)">
            </div>
			
			            <div class="form-group">
                <label for="nomeSocial">CLOROFÓRMIO</label>
                <input type="text" id="nomeSocial" name="nomeSocial" placeholder="DIGITE O NOME SOCIAL COMPLETO SEM ABREVIAÇÕES CASO POSSUA" autocomplete="off" oninput="maiusculas(this); markAsFilled(this)">
            </div>
			
	        <div class="form-group">
                <label for="nomeSocial">HIDRÓXIDO DE POTÁSSIO</label>
                <input type="text" id="nomeSocial" name="nomeSocial" placeholder="DIGITE O NOME SOCIAL COMPLETO SEM ABREVIAÇÕES CASO POSSUA" autocomplete="off" oninput="maiusculas(this); markAsFilled(this)">
            </div>
	
	        <div class="form-group">
                <label for="nomeSocial">IODO</label>
                <input type="text" id="nomeSocial" name="nomeSocial" placeholder="DIGITE O NOME SOCIAL COMPLETO SEM ABREVIAÇÕES CASO POSSUA" autocomplete="off" oninput="maiusculas(this); markAsFilled(this)">
            </div>


	
            </div>
            <div class="form-group">
                <label for="rgCnh">NOTA FISCAL</label>
                <input type="file" id="rgCnh" name="rgCnh" accept="application/pdf" onchange="markAsFilled(this)" required>
            </div>
            
            <button type="submit" class="form-button">Enviar</button>
        </form>
    </div>

    <script>
        
		
		
		
		
		
const scriptURL = "https://script.google.com/macros/s/AKfycbxbrDRXzssJDXMie95MJ7KvmNmKejyDaVVcX87NP6PgKOlihctwJ6NUF9B84ng6Ljdptw/exec";
const form = document.forms["contact-form"];

// Função para formatar data para o padrão brasileiro (DD/MM/AAAA)
function formatarDataBrasileira(data) {
    if (!data) return data;
    const [ano, mes, dia] = data.split('-');
    return `${dia.padStart(2, '0')}/${mes.padStart(2, '0')}/${ano}`;
}

form.addEventListener("submit", async (e) => {
    e.preventDefault();
    const formData = new FormData(form);

    // Função para ler arquivos como Base64
    async function readFileAsBase64(file) {
        return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.onload = () => resolve(reader.result.split(",")[1]);
            reader.onerror = reject;
            reader.readAsDataURL(file);
        });
    }

    // Validar os arquivos antes de enviar
    const fileInputs = ["rgCnh", "comprovante", "evento", "cadin"];
    let hasInvalidFile = false;

    fileInputs.forEach(inputId => {
        const file = document.getElementById(inputId).files[0];
        if (file && file.type !== "application/pdf") {
            alert(`O arquivo em ${inputId} deve ser um PDF.`);
            hasInvalidFile = true;
        }
    });

    if (hasInvalidFile) return;

    try {
        // Ler os arquivos PDF como Base64
        const rgCnhBase64 = document.getElementById("rgCnh").files[0] ? await readFileAsBase64(document.getElementById("rgCnh").files[0]) : null;
        const comprovanteBase64 = document.getElementById("comprovante").files[0] ? await readFileAsBase64(document.getElementById("comprovante").files[0]) : null;
        const eventoBase64 = document.getElementById("evento").files[0] ? await readFileAsBase64(document.getElementById("evento").files[0]) : null;
        const cadinBase64 = document.getElementById("cadin").files[0] ? await readFileAsBase64(document.getElementById("cadin").files[0]) : null;

        // Converter FormData para objeto e tratar os dados
        const dados = Object.fromEntries(formData.entries());

        // Converter campos de texto para maiúsculas (exceto datas)
        Object.keys(dados).forEach(key => {
            if (typeof dados[key] === 'string') {
                // Verifica se o valor parece uma data (formato AAAA-MM-DD)
                if (/^\d{4}-\d{2}-\d{2}$/.test(dados[key])) {
                    dados[key] = formatarDataBrasileira(dados[key]);
                } else {
                    dados[key] = dados[key].toUpperCase();
                }
            }
        });

        // Adicionar os arquivos ao objeto de dados
        const data = {
            ...dados,
            rgCnh: rgCnhBase64,
            comprovante: comprovanteBase64,
            evento: eventoBase64,
            cadin: cadinBase64,
        };

        // Enviar os dados para o Google Apps Script
        const submitButton = document.querySelector("button[type='submit']");
        submitButton.disabled = true;
        submitButton.innerText = "Enviando formulário. Aguarde...";

        await fetch(scriptURL, {
            method: "POST",
            body: JSON.stringify(data),
            headers: {
                "Content-Type": "application/json",
            },
            mode: "no-cors",
        });

        // Sem mensagem após o envio, apenas limpar o formulário
        form.reset();
        form.querySelectorAll('.filled').forEach(input => input.classList.remove('filled'));

    } catch (error) {
        alert("Erro: " + error.message);
        console.error("Erro detalhado:", error);
    } finally {
        const submitButton = document.querySelector("button[type='submit']");
        submitButton.disabled = false;
        submitButton.innerText = "Enviar";
    }
});
	
	
	
	
	
		 // Função para converter data de nascimento	
		function aplicarMascaraData(input) {
		let valor = input.value.replace(/\D/g, ''); // Remove tudo que não é número
		if (valor.length > 8) valor = valor.slice(0, 8); // Limita a 8 dígitos (DDMMAAAA)

		if (valor.length > 4) {
			valor = valor.slice(0, 2) + '/' + valor.slice(2, 4) + '/' + valor.slice(4);
		} else if (valor.length > 2) {
			valor = valor.slice(0, 2) + '/' + valor.slice(2);
		}
		
		input.value = valor;
}	
		
		

		

        // Função para converter texto em maiúsculas
        function maiusculas(input) {
            input.value = input.value.toUpperCase();
        }

        // Função para aplicar a máscara no campo de CPF
        function formatarCPF(input) {
            let valor = input.value;

            // Remove todos os caracteres não numéricos
            valor = valor.replace(/\D/g, "");

            // Aplica a máscara no formato XXX.XXX.XXX-XX
            if (valor.length <= 11) {
                valor = valor.replace(/(\d{3})(\d{0,3})(\d{0,3})(\d{0,2})/, function(_, p1, p2, p3, p4) {
                    return p1 + (p2 ? "." + p2 : "") + (p3 ? "." + p3 : "") + (p4 ? "-" + p4 : "");
                });
            }

            input.value = valor;
        }

        // Função para marcar o campo como preenchido (mudar a cor)
        //function markAsFilled(input) {
        //    if (input.value.trim() !== "") {
        //        input.classList.add("filled");
        //    } else {
        //        input.classList.remove("filled");
        //    }
        //}






        // Função para aplicar a máscara de CEP
        function maskCEP(input) {
            input.value = input.value.replace(/\D/g, "");
            input.value = input.value.replace(/^(\d{5})(\d{3})$/, "$1-$2");
        }

        // Função para buscar o CEP e preencher os campos automaticamente
        function buscarCEP() {
            let cep = document.getElementById('cep').value.replace("-", "");
            if (cep.length === 8) {
                fetch(`https://viacep.com.br/ws/${cep}/json/`)
                    .then(response => response.json())
                    .then(data => {
                        if (!data.erro) {
                            document.getElementById('logradouro').value = data.logradouro;
                            document.getElementById('bairro').value = data.bairro;
                            document.getElementById('cidade').value = data.localidade;
                            document.getElementById('estado').value = data.uf;
                            markAsFilled(document.getElementById('logradouro'));
                            markAsFilled(document.getElementById('bairro'));
                            markAsFilled(document.getElementById('cidade'));
                            markAsFilled(document.getElementById('estado'));
                        }
                    })
                    .catch(error => console.error('Erro ao buscar o CEP:', error));
            }
        }
		
		
		
		
		
	function validarData(input) {
    const valor = input.value;
    const regex = /^\d{2}\/\d{2}\/\d{4}$/;
    if (!regex.test(valor)) {
        alert("Por favor, insira a data no formato DD/MM/AAAA.");
        input.value = "";
    }
}
		
		
				
		

        // Define a data mínima como amanhã para os campos de data
        function setMinDate() {
            const today = new Date();
            const tomorrow = new Date(today);
            tomorrow.setDate(today.getDate() + 1);
            const minDate = tomorrow.toISOString().split('T')[0];

            document.getElementById('inicio').setAttribute('min', minDate);
            document.getElementById('termino').setAttribute('min', minDate);
            document.getElementById('prazo').setAttribute('min', minDate);
        }

        // Chama a função para configurar a data mínima assim que a página for carregada
        window.onload = setMinDate;
    </script>
</body>
</html>
